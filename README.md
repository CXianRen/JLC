# Javalette Compiler
This project develops a toy language (JLC), that combines of C and Java.

The compiler consists two parts: the front end and the back end.

The front end is generated by [BNFC](https://bnfc.digitalgrammars.com/), using the syntax configuration file [javalette.cf](./src/Javalette.cf) under src.

And the back end also generally consists two parts : Type checker and llvm generator. 

Additionally, for easy debugging of syntax configuration, a simple web interface is provide to show the parsed AST is provided. You can find it at [ast_viewer](./ast_viewer/)

# How to run this project
## Clone 
```shell 
git clone xxx

# pull submodule which includes the testsuit
git submodule update --init 
```


## Env
1. Compiling this project doesn't require any additional dependeces. 
2. However running it with LLVM requires llvm package to be installed. (>=16.0.0).
3. And if you want to regenerate the parser, which means you want to modify the syntax configuration, you need to install BNFC package. 

## Regenerate 
```shell 
make gen
```
The code under [parser part](./src/parser/) will be regenerated.   

## JLC
```shell
make jlc
```
jlc, is the compiler we use to compile xxx.jl


## Test-ut
```shell
make test
```
It compiles all the `test_xxx.cpp` files under [test](./src/test/).


# JLC:javelette

# Compiler design 
![img](./doc/type_checker.png)

## Typer Checker
In this stage, type checking is seperated into several detail stages. The code is located under src/typechecker.

Generally, it includes stage:  
1. user defined type declearation [jlc_tc_udt_dcl.cpp](./src/typechecker/jlc_tc_udt_dcl.cpp)
2. user defined type definition [jlc_tc_udt_def.cpp](./src/typechecker/jlc_tc_func_def.cpp)
3. function declearation [jlc_tc_func_dcl.cpp](./src/typechecker/jlc_tc_func_dcl.h)
4. function definition [jlc_tc_func_def.cpp](./src/typechecker/jlc_tc_func_def.cpp)

## LLVM generator
Instead of using LLVM development framework directly, we implemented a set of APIs [llvm.cpp](./src/llvm/llvm.cpp) to generate LLVM code ourselves.

More specific design details will be discussed in the following documents.

[Control flow](./doc/control_flow.md)  
[Array](./doc/array.md)  
[Enum](./doc/enum.md)  
[Struct](./doc/struct.md)  
[Class](./doc/class.md)  
[Runtime polymorphically](./doc/polymorphically.md)  